// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: 20260215-717476ad
//     Generated: 2026-02-15 18:29:05 UTC
//     Source: simple-bounded-context.json
// </auto-generated>

#nullable enable

using Inventorization.Commerce.Domain.Validators;
using Inventorization.Commerce.DTO.Product;

namespace Inventorization.Commerce.API.Tests.Validators;

public class ProductValidatorTests
{
    [Fact]
    public async Task CreateValidator_ReturnsOk_WhenDtoValid()
    {
        var validator = new CreateProductValidator();
        var dto = CreateValidCreateDto();

        var result = await validator.ValidateAsync(dto);

        result.IsValid.Should().BeTrue();
    }

    [Theory]
    [MemberData(nameof(InvalidCreateDtos))]
    public async Task CreateValidator_ReturnsErrors_WhenDtoInvalid(CreateProductDTO dto)
    {
        var validator = new CreateProductValidator();

        var result = await validator.ValidateAsync(dto);

        result.IsValid.Should().BeFalse();
    }

    [Fact]
    public async Task UpdateValidator_ReturnsOk_WhenDtoValid()
    {
        var validator = new UpdateProductValidator();
        var dto = CreateValidUpdateDto();

        var result = await validator.ValidateAsync(dto);

        result.IsValid.Should().BeTrue();
    }

    [Theory]
    [MemberData(nameof(InvalidUpdateDtos))]
    public async Task UpdateValidator_ReturnsErrors_WhenDtoInvalid(UpdateProductDTO dto)
    {
        var validator = new UpdateProductValidator();

        var result = await validator.ValidateAsync(dto);

        result.IsValid.Should().BeFalse();
    }

    public static IEnumerable<object[]> InvalidCreateDtos => new List<object[]>
    {
        new object[] { CreateValidCreateDto(dto => dto.Name = string.Empty) },
        new object[] { CreateValidCreateDto(dto => dto.Name = new string('a', 201)) },
        new object[] { CreateValidCreateDto(dto => dto.SKU = string.Empty) },
        new object[] { CreateValidCreateDto(dto => dto.SKU = new string('a', 51)) },
        new object[] { CreateValidCreateDto(dto => dto.SKU = "invalid") },
        new object[] { CreateValidCreateDto(dto => dto.Description = new string('a', 2001)) },
        new object[] { CreateValidCreateDto(dto => dto.Price = (0m - 1m)) },
        new object[] { CreateValidCreateDto(dto => dto.StockQuantity = (0 - 1)) },
    };

    public static IEnumerable<object[]> InvalidUpdateDtos => new List<object[]>
    {
        new object[] { CreateValidUpdateDto(dto => dto.Id = Guid.Empty) },
        new object[] { CreateValidUpdateDto(dto => dto.Name = string.Empty) },
        new object[] { CreateValidUpdateDto(dto => dto.Name = new string('a', 201)) },
        new object[] { CreateValidUpdateDto(dto => dto.SKU = string.Empty) },
        new object[] { CreateValidUpdateDto(dto => dto.SKU = new string('a', 51)) },
        new object[] { CreateValidUpdateDto(dto => dto.SKU = "invalid") },
        new object[] { CreateValidUpdateDto(dto => dto.Description = new string('a', 2001)) },
        new object[] { CreateValidUpdateDto(dto => dto.Price = (0m - 1m)) },
        new object[] { CreateValidUpdateDto(dto => dto.StockQuantity = (0 - 1)) },
    };

    private static CreateProductDTO CreateValidCreateDto(Action<CreateProductDTO>? mutate = null)
    {
        var dto = new CreateProductDTO
        {
            Name = new string('a', 1),
            SKU = "SKU-1",
            Description = new string('a', 1),
            Price = 0m,
            StockQuantity = 0,
            Status = ProductStatus.Draft,
            IsActive = true,
        };

        mutate?.Invoke(dto);
        return dto;
    }

    private static UpdateProductDTO CreateValidUpdateDto(Action<UpdateProductDTO>? mutate = null)
    {
        var dto = new UpdateProductDTO
        {
            Id = Guid.NewGuid(),
            Name = new string('a', 1),
            SKU = "SKU-1",
            Description = new string('a', 1),
            Price = 0m,
            StockQuantity = 0,
            Status = ProductStatus.Draft,
            IsActive = true,
        };

        mutate?.Invoke(dto);
        return dto;
    }
}
