// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: 20260215-38d150ed
//     Generated: 2026-02-15 09:53:00 UTC
//     Source: simple-bounded-context.json
//
//     Changes to this file will be lost when regenerated.
//     Custom business logic should be added to separate domain services.
// </auto-generated>

using Inventorization.Base.Models;
using Inventorization.Commerce.Common.Enums;

namespace Inventorization.Commerce.Domain.Entities;

/// <summary>
/// Product in the catalog
/// </summary>
public class Product : BaseEntity
{
    /// <summary>
    /// Private parameterless constructor for EF Core
    /// </summary>
    private Product() { }

    /// <summary>
    /// Creates a new instance of Product
    /// </summary>
    /// <param name="name">Product name</param>
    /// <param name="sKU">Stock keeping unit (unique identifier)</param>
    /// <param name="description">Product description</param>
    /// <param name="price">Product price</param>
    /// <param name="stockQuantity">Available stock quantity</param>
    /// <param name="categoryId">Category ID</param>
    /// <param name="status">Product status</param>
    /// <param name="isActive">Whether the product is active</param>
    public Product(
        string name,
        string sKU,
        string description,
        decimal price,
        int stockQuantity,
        Guid categoryId,
        ProductStatus status,
        bool isActive
    )
    {
        if (string.IsNullOrWhiteSpace(name)) throw new ArgumentException("Name cannot be empty", nameof(name));
        if (name.Length > 200) throw new ArgumentException("Name cannot exceed 200 characters", nameof(name));
        if (string.IsNullOrWhiteSpace(sKU)) throw new ArgumentException("SKU cannot be empty", nameof(sKU));
        if (sKU.Length > 50) throw new ArgumentException("SKU cannot exceed 50 characters", nameof(sKU));
        if (description.Length > 2000) throw new ArgumentException("Description cannot exceed 2000 characters", nameof(description));
        if (price < 0) throw new ArgumentException("Price must be at least 0", nameof(price));
        if (stockQuantity < 0) throw new ArgumentException("StockQuantity must be at least 0", nameof(stockQuantity));

        Name = name;
        SKU = sKU;
        Description = description;
        Price = price;
        StockQuantity = stockQuantity;
        CategoryId = categoryId;
        Status = status;
        IsActive = isActive;

        Id = Guid.NewGuid();
        CreatedAt = DateTime.UtcNow;
        UpdatedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Product name
    /// </summary>
    public string Name { get; private set; }

    /// <summary>
    /// Stock keeping unit (unique identifier)
    /// </summary>
    public string SKU { get; private set; }

    /// <summary>
    /// Product description
    /// </summary>
    public string Description { get; private set; }

    /// <summary>
    /// Product price
    /// </summary>
    public decimal Price { get; private set; }

    /// <summary>
    /// Available stock quantity
    /// </summary>
    public int StockQuantity { get; private set; } = 0;

    /// <summary>
    /// Category ID
    /// </summary>
    public Guid CategoryId { get; private set; }

    /// <summary>
    /// Product status
    /// </summary>
    public ProductStatus Status { get; private set; } = ProductStatus.Draft;

    /// <summary>
    /// Whether the product is active
    /// </summary>
    public bool IsActive { get; private set; } = true;

    /// <summary>
    /// Navigation to Category
    /// </summary>
    public Category Category { get; } = null!;

    /// <summary>
    /// Collection of OrderItem
    /// </summary>
    public ICollection<OrderItem> OrderItems { get; } = new List<OrderItem>(10);

    /// <summary>
    /// Timestamp when the entity was created
    /// </summary>
    public DateTime CreatedAt { get; private set; }

    /// <summary>
    /// Timestamp when the entity was last updated
    /// </summary>
    public DateTime? UpdatedAt { get; private set; }

    /// <summary>
    /// Updates Product with new values
    /// </summary>
    /// <param name="name">Product name</param>
    /// <param name="sKU">Stock keeping unit (unique identifier)</param>
    /// <param name="description">Product description</param>
    /// <param name="price">Product price</param>
    /// <param name="stockQuantity">Available stock quantity</param>
    /// <param name="status">Product status</param>
    /// <param name="isActive">Whether the product is active</param>
    public void Update(
        string name,
        string sKU,
        string description,
        decimal price,
        int stockQuantity,
        ProductStatus status,
        bool isActive
    )
    {
        if (string.IsNullOrWhiteSpace(name)) throw new ArgumentException("Name cannot be empty", nameof(name));
        if (name.Length > 200) throw new ArgumentException("Name cannot exceed 200 characters", nameof(name));
        if (string.IsNullOrWhiteSpace(sKU)) throw new ArgumentException("SKU cannot be empty", nameof(sKU));
        if (sKU.Length > 50) throw new ArgumentException("SKU cannot exceed 50 characters", nameof(sKU));
        if (description.Length > 2000) throw new ArgumentException("Description cannot exceed 2000 characters", nameof(description));
        if (price < 0) throw new ArgumentException("Price must be at least 0", nameof(price));
        if (stockQuantity < 0) throw new ArgumentException("StockQuantity must be at least 0", nameof(stockQuantity));

        Name = name;
        SKU = sKU;
        Description = description;
        Price = price;
        StockQuantity = stockQuantity;
        Status = status;
        IsActive = isActive;

        UpdatedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Category ID
    /// </summary>
    /// <param name="categoryId">Category identifier</param>
    public void SetCategory(Guid categoryId)
    {
        CategoryId = categoryId;
        UpdatedAt = DateTime.UtcNow;
    }

}
