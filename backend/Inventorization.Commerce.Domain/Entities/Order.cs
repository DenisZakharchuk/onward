// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: 20260214-618b8d7c
//     Generated: 2026-02-14 15:54:12 UTC
//     Source: simple-bounded-context.json
//
//     Changes to this file will be lost when regenerated.
//     Custom business logic should be added to separate domain services.
// </auto-generated>

using Inventorization.Base.Models;
using Inventorization.Commerce.Common.Enums;

namespace Inventorization.Commerce.Domain.Entities;

/// <summary>
/// Customer order
/// </summary>
public class Order : BaseEntity
{
    /// <summary>
    /// Private parameterless constructor for EF Core
    /// </summary>
    private Order() { }

    /// <summary>
    /// Creates a new instance of Order
    /// </summary>
    /// <param name="customerId">Customer ID</param>
    /// <param name="orderNumber">Unique order number</param>
    /// <param name="orderDate">Order date and time</param>
    /// <param name="totalAmount">Total order amount</param>
    /// <param name="status">Order status</param>
    /// <param name="shippingAddressId">Shipping address ID</param>
    public Order(
        Guid customerId,
        string orderNumber,
        DateTime orderDate,
        decimal totalAmount,
        OrderStatus status,
        Guid shippingAddressId
    )
    {
        if (string.IsNullOrWhiteSpace(orderNumber)) throw new ArgumentException("OrderNumber cannot be empty", nameof(orderNumber));
        if (orderNumber.Length > 50) throw new ArgumentException("OrderNumber cannot exceed 50 characters", nameof(orderNumber));
        if (totalAmount < 0) throw new ArgumentException("TotalAmount must be at least 0", nameof(totalAmount));

        CustomerId = customerId;
        OrderNumber = orderNumber;
        OrderDate = orderDate;
        TotalAmount = totalAmount;
        Status = status;
        ShippingAddressId = shippingAddressId;

        Id = Guid.NewGuid();
        CreatedAt = DateTime.UtcNow;
        UpdatedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Customer ID
    /// </summary>
    public Guid CustomerId { get; private set; }

    /// <summary>
    /// Unique order number
    /// </summary>
    public string OrderNumber { get; private set; }

    /// <summary>
    /// Order date and time
    /// </summary>
    public DateTime OrderDate { get; private set; }

    /// <summary>
    /// Total order amount
    /// </summary>
    public decimal TotalAmount { get; private set; }

    /// <summary>
    /// Order status
    /// </summary>
    public OrderStatus Status { get; private set; } = OrderStatus.Pending;

    /// <summary>
    /// Shipping address ID
    /// </summary>
    public Guid ShippingAddressId { get; private set; }

    /// <summary>
    /// Navigation to Customer
    /// </summary>
    public Customer Customer { get; } = null!;

    /// <summary>
    /// Navigation to Address
    /// </summary>
    public Address ShippingAddress { get; } = null!;

    /// <summary>
    /// Collection of OrderItem
    /// </summary>
    public ICollection<OrderItem> OrderItems { get; } = new List<OrderItem>();

    /// <summary>
    /// Timestamp when the entity was created
    /// </summary>
    public DateTime CreatedAt { get; private set; }

    /// <summary>
    /// Timestamp when the entity was last updated
    /// </summary>
    public DateTime? UpdatedAt { get; private set; }

    /// <summary>
    /// Updates Order with new values
    /// </summary>
    /// <param name="orderNumber">Unique order number</param>
    /// <param name="orderDate">Order date and time</param>
    /// <param name="totalAmount">Total order amount</param>
    /// <param name="status">Order status</param>
    public void Update(
        string orderNumber,
        DateTime orderDate,
        decimal totalAmount,
        OrderStatus status
    )
    {
        if (string.IsNullOrWhiteSpace(orderNumber)) throw new ArgumentException("OrderNumber cannot be empty", nameof(orderNumber));
        if (orderNumber.Length > 50) throw new ArgumentException("OrderNumber cannot exceed 50 characters", nameof(orderNumber));
        if (totalAmount < 0) throw new ArgumentException("TotalAmount must be at least 0", nameof(totalAmount));

        OrderNumber = orderNumber;
        OrderDate = orderDate;
        TotalAmount = totalAmount;
        Status = status;

        UpdatedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Customer ID
    /// </summary>
    /// <param name="customerId">Customer identifier</param>
    public void SetCustomer(Guid customerId)
    {
        CustomerId = customerId;
        UpdatedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Shipping address ID
    /// </summary>
    /// <param name="shippingAddressId">Address identifier</param>
    public void SetAddress(Guid shippingAddressId)
    {
        ShippingAddressId = shippingAddressId;
        UpdatedAt = DateTime.UtcNow;
    }

}
