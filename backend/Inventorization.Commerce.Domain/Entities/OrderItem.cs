// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: 20260215-717476ad
//     Generated: 2026-02-15 18:29:05 UTC
//     Source: simple-bounded-context.json
//
//     Changes to this file will be lost when regenerated.
//     Custom business logic should be added to separate domain services.
// </auto-generated>

using Inventorization.Base.Models;

namespace Inventorization.Commerce.Domain.Entities;

/// <summary>
/// Order line item
/// </summary>
public class OrderItem : BaseEntity
{
    /// <summary>
    /// Private parameterless constructor for EF Core
    /// </summary>
    private OrderItem() { }

    /// <summary>
    /// Creates a new instance of OrderItem
    /// </summary>
    /// <param name="orderId">Order ID</param>
    /// <param name="productId">Product ID</param>
    /// <param name="quantity">Quantity ordered</param>
    /// <param name="unitPrice">Price per unit at time of order</param>
    /// <param name="totalPrice">Total price for this line item</param>
    public OrderItem(
        Guid orderId,
        Guid productId,
        int quantity,
        decimal unitPrice,
        decimal totalPrice
    )
    {
        if (quantity < 1) throw new ArgumentException("Quantity must be at least 1", nameof(quantity));
        if (unitPrice < 0) throw new ArgumentException("UnitPrice must be at least 0", nameof(unitPrice));
        if (totalPrice < 0) throw new ArgumentException("TotalPrice must be at least 0", nameof(totalPrice));

        OrderId = orderId;
        ProductId = productId;
        Quantity = quantity;
        UnitPrice = unitPrice;
        TotalPrice = totalPrice;

        Id = Guid.NewGuid();
        CreatedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Order ID
    /// </summary>
    public Guid OrderId { get; private set; }

    /// <summary>
    /// Product ID
    /// </summary>
    public Guid ProductId { get; private set; }

    /// <summary>
    /// Quantity ordered
    /// </summary>
    public int Quantity { get; private set; }

    /// <summary>
    /// Price per unit at time of order
    /// </summary>
    public decimal UnitPrice { get; private set; }

    /// <summary>
    /// Total price for this line item
    /// </summary>
    public decimal TotalPrice { get; private set; }

    /// <summary>
    /// Navigation to Order
    /// </summary>
    public Order Order { get; } = null!;

    /// <summary>
    /// Navigation to Product
    /// </summary>
    public Product Product { get; } = null!;

    /// <summary>
    /// Timestamp when the entity was created
    /// </summary>
    public DateTime CreatedAt { get; private set; }

    /// <summary>
    /// Updates OrderItem with new values
    /// </summary>
    /// <param name="quantity">Quantity ordered</param>
    /// <param name="unitPrice">Price per unit at time of order</param>
    /// <param name="totalPrice">Total price for this line item</param>
    public void Update(
        int quantity,
        decimal unitPrice,
        decimal totalPrice
    )
    {
        if (quantity < 1) throw new ArgumentException("Quantity must be at least 1", nameof(quantity));
        if (unitPrice < 0) throw new ArgumentException("UnitPrice must be at least 0", nameof(unitPrice));
        if (totalPrice < 0) throw new ArgumentException("TotalPrice must be at least 0", nameof(totalPrice));

        Quantity = quantity;
        UnitPrice = unitPrice;
        TotalPrice = totalPrice;

    }

    /// <summary>
    /// Order ID
    /// </summary>
    /// <param name="orderId">Order identifier</param>
    public void SetOrder(Guid orderId)
    {
        OrderId = orderId;
    }

    /// <summary>
    /// Product ID
    /// </summary>
    /// <param name="productId">Product identifier</param>
    public void SetProduct(Guid productId)
    {
        ProductId = productId;
    }

}
