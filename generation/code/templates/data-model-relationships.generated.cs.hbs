// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: {{generationStamp}}
//     Generated: {{generatedAt}}
//     Source: {{sourceFile}}
//
//     Changes to this file will be lost when regenerated.
// </auto-generated>

using {{baseNamespace}}.Base.Models;

namespace {{namespace}}.Meta;

/// <summary>
/// Centralized repository of all relationship metadata for {{contextName}} bounded context.
/// Single source of truth for entity relationships - used by relationship managers,
/// configurations, and DI registration.
/// All metadata is string-based and does not reference domain entities.
/// </summary>
public static class DataModelRelationships
{
    {{#each relationships}}
    /// <summary>
    /// {{leftEntity}} {{#ifEquals type 'ManyToMany'}}↔{{else}}→{{/ifEquals}} {{rightEntity}} {{typeDescription}}
    /// {{description}}
    /// </summary>
    public static readonly RelationshipMetadata {{name}} = new RelationshipMetadata
    {
        RelationshipName = "{{name}}",
        Type = RelationshipType.{{type}},
        Cardinality = RelationshipCardinality.{{cardinality}},
        PrincipalEntity = "{{leftEntity}}",
        DependentEntity = "{{rightEntity}}",
        DisplayName = "{{displayName}}",
        {{#if junctionEntityName}}JunctionEntityName = "{{junctionEntityName}}",{{/if}}
        {{#if navigationPropertyName}}NavigationPropertyName = "{{navigationPropertyName}}",{{/if}}
        {{#if inverseNavigationPropertyName}}InverseNavigationPropertyName = "{{inverseNavigationPropertyName}}",{{/if}}
        {{#if foreignKeyPropertyName}}ForeignKeyPropertyName = "{{foreignKeyPropertyName}}",{{/if}}
        Description = "{{description}}"
    };

    {{/each}}
    
    #region Helper Methods

    /// <summary>
    /// Get all relationship metadata
    /// </summary>
    public static IReadOnlyList<RelationshipMetadata> GetAllRelationships() => new List<RelationshipMetadata>
    {
        {{#each relationships}}
        {{name}}{{#unless @last}},{{/unless}}
        {{/each}}
    };

    /// <summary>
    /// Get relationships involving a specific entity
    /// </summary>
    public static IReadOnlyList<RelationshipMetadata> GetRelationshipsForEntity(string entityName)
    {
        return GetAllRelationships()
            .Where(r => r.PrincipalEntity == entityName || r.DependentEntity == entityName)
            .ToList();
    }

    #endregion
}
