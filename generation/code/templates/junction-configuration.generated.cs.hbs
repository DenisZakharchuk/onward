// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>

using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Metadata.Builders;
using {{namespace}}.Domain.Entities;
using {{namespace}}.Meta;
using {{baseNamespace}}.Base.DataAccess;
using {{baseNamespace}}.Base.Models;

namespace {{namespace}}.Domain.EntityConfigurations;

/// <summary>
/// Entity configuration for {{junctionName}} junction entity
/// </summary>
public class {{junctionName}}Configuration : JunctionEntityConfiguration<{{junctionName}}, {{leftEntity}}, {{rightEntity}}>
{
    public {{junctionName}}Configuration() : base(DataModelRelationships.{{junctionName}})
    {
    }

    protected override void ConfigureJunctionEntity(EntityTypeBuilder<{{junctionName}}> builder)
    {
        builder.ToTable("{{tableName}}"{{#if schema}}, "{{schema}}"{{/if}});

        {{#each propertyConfigurations}}
        {{{this}}}

        {{/each}}
        {{#if hasRelationships}}
        // Relationships - CASCADE DELETE PROHIBITED
        builder.HasOne(e => e.{{leftEntity}})
            .WithMany(x => x.{{junctionName}}s)
            .HasForeignKey(e => e.EntityId)
            .OnDelete(DeleteBehavior.Restrict);

        builder.HasOne(e => e.{{rightEntity}})
            .WithMany(x => x.{{junctionName}}s)
            .HasForeignKey(e => e.RelatedEntityId)
            .OnDelete(DeleteBehavior.Restrict);
        {{/if}}
    }
}
