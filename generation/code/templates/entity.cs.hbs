// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: {{generationStamp}}
//     Generated: {{generatedAt}}
//     Source: {{sourceFile}}
//
//     Changes to this file will be lost when regenerated.
//     Custom business logic should be added to separate domain services.
// </auto-generated>

using {{baseNamespace}}.Base.Models;
{{#if hasEnums}}
using {{namespace}}.Common.Enums;
{{/if}}

namespace {{namespace}}.Domain.Entities;

/// <summary>
/// {{description}}
/// </summary>
public class {{entityName}} : BaseEntity
{
    /// <summary>
    /// Private parameterless constructor for EF Core
    /// </summary>
    private {{entityName}}() { }

    /// <summary>
    /// Creates a new instance of {{entityName}}
    /// </summary>
    {{#each constructorParams}}
    /// <param name="{{paramName}}">{{paramDescription}}</param>
    {{/each}}
    public {{entityName}}(
        {{#each constructorParams}}
        {{type}} {{paramName}}{{#unless @last}},{{/unless}}
        {{/each}}
    )
    {
        {{#each validations}}
        {{{this}}}
        {{/each}}

        {{#each propertyAssignments}}
        {{{this}}}
        {{/each}}

        Id = Guid.NewGuid();
        CreatedAt = DateTime.UtcNow;
        {{#if auditable}}
        UpdatedAt = DateTime.UtcNow;
        {{/if}}
    }

    {{#each properties}}
    {{#if description}}
    /// <summary>
    /// {{description}}
    /// </summary>
    {{/if}}
    public {{type}} {{name}} { get; private set; }{{#if defaultValue}} = {{defaultValue}};{{/if}}

    {{/each}}
    {{#each navigationProperties}}
    {{#if description}}
    /// <summary>
    /// {{description}}
    /// </summary>
    {{/if}}
    {{#if isCollection}}
    public ICollection<{{type}}> {{name}} { get; } = new List<{{type}}>();
    {{else}}
    public {{type}}{{#if nullable}}?{{/if}} {{name}} { get; } = null!;
    {{/if}}

    {{/each}}
    /// <summary>
    /// Timestamp when the entity was created
    /// </summary>
    public DateTime CreatedAt { get; private set; }

    {{#if auditable}}
    /// <summary>
    /// Timestamp when the entity was last updated
    /// </summary>
    public DateTime? UpdatedAt { get; private set; }

    {{/if}}
    {{#if hasUpdateMethod}}
    /// <summary>
    /// Updates {{entityName}} with new values
    /// </summary>
    {{#each updateParams}}
    /// <param name="{{paramName}}">{{paramDescription}}</param>
    {{/each}}
    public void Update(
        {{#each updateParams}}
        {{type}} {{paramName}}{{#unless @last}},{{/unless}}
        {{/each}}
    )
    {
        {{#each updateValidations}}
        {{{this}}}
        {{/each}}

        {{#each updateAssignments}}
        {{{this}}}
        {{/each}}

        {{#if auditable}}
        UpdatedAt = DateTime.UtcNow;
        {{/if}}
    }

    {{/if}}
    {{#each foreignKeySetters}}
    /// <summary>
    /// {{description}}
    /// </summary>
    /// <param name="{{paramName}}">{{entityName}} identifier</param>
    public void Set{{entityName}}(Guid {{paramName}})
    {
        {{fkName}} = {{paramName}};
        {{#if ../auditable}}
        UpdatedAt = DateTime.UtcNow;
        {{/if}}
    }

    {{/each}}
}
