// <auto-generated>
//     This code was generated by the BoundedContext Code Generator.
//     Generation Stamp: {{generationStamp}}
//     Generated: {{generatedAt}}
//     Source: {{sourceFile}}
//
//     Changes to this file will be lost when regenerated.
// </auto-generated>

using {{baseNamespace}}.Base.Models;

namespace {{namespace}}.Meta;

/// <summary>
/// Centralized repository of all entity metadata for {{contextName}} bounded context.
/// Single source of truth for entity structure, validation rules, and EF configuration.
/// Use this metadata for:
/// - Generating validators
/// - Configuring EF Core models
/// - Generating UI forms
/// - API documentation
/// - Code generation
/// All metadata is string-based and does not reference domain entities.
/// </summary>
public static class DataModelMetadata
{
    {{#each entities}}
    {{#unless isJunction}}
    #region {{name}} Entity Metadata

    /// <summary>
    /// Complete metadata for the {{name}} entity
    /// </summary>
    public static readonly EntityMetadata {{name}} = new EntityMetadata
    {
        EntityName = "{{name}}",
        TableName = "{{tableName}}",
        {{#if schema}}SchemaName = "{{schema}}",{{/if}}
        DisplayName = "{{displayName}}",
        Description = "{{description}}",
        HasAuditing = {{#if auditable}}true{{else}}false{{/if}},
        Properties = new PropertyMetadata[]
        {
            {{#each properties}}
            new PropertyMetadata
            {
                PropertyName = "{{name}}",
                PropertyType = "{{type}}",{{#if displayName}}
                DisplayName = "{{displayName}}",{{/if}}{{#if isPrimaryKey}}
                IsPrimaryKey = true,{{/if}}
                IsRequired = {{required}},
                IsNullable = {{nullable}},{{#if maxLength}}
                MaxLength = {{maxLength}},{{/if}}{{#if minLength}}
                MinLength = {{minLength}},{{/if}}{{#if precision}}
                Precision = {{precision}},{{/if}}{{#if scale}}
                Scale = {{scale}},{{/if}}{{#if columnType}}
                ColumnType = "{{columnType}}",{{/if}}{{#if isUnique}}
                IsUnique = true,{{/if}}{{#if isForeignKey}}
                IsForeignKey = true,{{/if}}{{#if isIndexed}}
                IsIndexed = true,{{/if}}{{#if minValue}}
                MinValue = {{minValue}},{{/if}}{{#if maxValue}}
                MaxValue = {{maxValue}},{{/if}}{{#if regexPattern}}
                RegexPattern = @"{{regexPattern}}",{{/if}}{{#if defaultValue}}
                DefaultValue = "{{defaultValue}}",{{/if}}{{#if defaultValueSql}}
                DefaultValueSql = "{{defaultValueSql}}",{{/if}}{{#if isEmail}}
                IsEmail = true,{{/if}}
                Description = "{{description}}"{{#if validationMessage}},
                ValidationMessage = "{{validationMessage}}"{{/if}}
            }{{#unless @last}},{{/unless}}
            {{/each}}
        },
        Indexes = new IndexMetadata[]
        {
            {{#each indexMetadata}}
            new IndexMetadata
            {
                Name = "{{name}}",
                Columns = new[] { {{#each columns}}"{{this}}"{{#unless @last}}, {{/unless}}{{/each}} },
                IsUnique = {{isUnique}}
            }{{#unless @last}},{{/unless}}
            {{/each}}
        },
        UniqueConstraints = new UniqueConstraintMetadata[]
        {
            {{#each uniqueConstraints}}
            new UniqueConstraintMetadata
            {
                Name = "{{name}}",
                Columns = new[] { {{#each columns}}"{{this}}"{{#unless @last}}, {{/unless}}{{/each}} }
            }{{#unless @last}},{{/unless}}
            {{/each}}
        }
    };

    #endregion

    {{/unless}}
    {{/each}}
    #region Helper Methods

    /// <summary>
    /// Get all entity metadata in this bounded context
    /// </summary>
    public static IReadOnlyList<EntityMetadata> GetAllEntityMetadata() => new List<EntityMetadata>
    {
        {{#each entities}}
        {{#unless isJunction}}
        {{name}}{{#unless @last}},{{/unless}}
        {{/unless}}
        {{/each}}
    };

    /// <summary>
    /// Get metadata for a specific entity by name
    /// </summary>
    public static EntityMetadata? GetEntityMetadata(string entityName) => entityName switch
    {
        {{#each entities}}
        {{#unless isJunction}}
        "{{name}}" => {{name}},
        {{/unless}}
        {{/each}}
        _ => null
    };

    #endregion
}
